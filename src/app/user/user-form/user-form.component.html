<div class="modal-header">
  <h4 class="modal-title" id="modal-basic-title">{{ pageHeader }}</h4>
  <button type="button" class="close" aria-label="Close" (click)="close(false)">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">
  <form [formGroup]="userForm">
    <div class="form-row">
      <div class="form-group col-sm-6 required">
        <label for="firstName" class="asterisk-if-mandatory">First Name</label>
        <input required formControlName="firstName" id="firstName" type="text" class="form-control" autocomplete="off"
          [ngClass]="{ 'is-invalid': formSubmitted && f.firstName.errors }">
        <div *ngIf="formSubmitted && f.firstName.errors" class="invalid-feedback">
          <div *ngIf="f.firstName.errors.required">First Name is required</div>
          <div *ngIf="f.firstName.errors?.minlength">First Name must be at least 5 characters long.</div>
        </div>
      </div>
      <div class="form-group col-sm-6 required">
        <label for="lastName" class="asterisk-if-mandatory">Last Name</label>
        <input required formControlName="lastName" id="lastName" type="text" class="form-control" autocomplete="off"
          [ngClass]="{ 'is-invalid': formSubmitted && f.lastName.errors }">
        <div *ngIf="formSubmitted && f.lastName.errors" class="invalid-feedback">
          <div *ngIf="f.lastName.errors.required">Last Name is required</div>
          <div *ngIf="f.lastName.errors?.minlength">Last Name must be at least 5 characters long.</div>
        </div>
      </div>
    </div>
    <!-- <div class="form-row">
      
    </div> -->
    <div class="form-row">
      <div class="form-group col-sm-12 required">
        <label for="email" class="asterisk-if-mandatory">Email</label>
        <input required formControlName="email" id="email" type="text" class="form-control" autocomplete="off"
          [ngClass]="{ 'is-invalid': formSubmitted && f.email.errors }">
        <div *ngIf="formSubmitted && f.email.errors" class="invalid-feedback">
          <div *ngIf="f.email.errors.required">Email is required</div>
          <div *ngIf="f.email.errors?.minlength">Email must be a valid email.</div>
        </div>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group col-sm-6 required" [hidden]='actionType == actionEnum.view || actionType == actionEnum.edit'>
        <label for="password" class="asterisk-if-mandatory">Password</label>
        <input required formControlName="password" id="password" type="text" class="form-control" autocomplete="off"
          [ngClass]="{ 'is-invalid': formSubmitted && f.password.errors }">
        <div *ngIf="formSubmitted && f.password.errors" class="invalid-feedback">
          <div *ngIf="f.password.errors.required">Password is required</div>
          <div *ngIf="f.password.errors?.minlength">Password must be at least 8 characters long.</div>
        </div>
      </div>
      <div class="form-group col-sm-6 required" [hidden]='actionType == actionEnum.view || actionType == actionEnum.edit'>
        <label for="confirmPassword" class="asterisk-if-mandatory">Confirm Password</label>
        <input required formControlName="confirmPassword" id="confirmPassword" type="text" class="form-control"
          autocomplete="off" [ngClass]="{ 'is-invalid': formSubmitted && f.confirmPassword.errors && f.confirmPassword.value != f.password.value}">
        <div *ngIf="formSubmitted && f.confirmPassword.errors" class="invalid-feedback">
          <div *ngIf="f.confirmPassword.errors.required">Confirm Password is required</div>
          <div *ngIf="f.confirmPassword.errors.invalid">Password doesn't match</div>
        </div>
      </div>
    </div>
    <!-- <div class="form-row">
      
    </div> -->
    <div class="form-row">
      <div class="form-group col-sm-6 required">
        <label for="role" class="asterisk-if-mandatory">DOB</label>
        <input required formControlName="dob" id="dob" type="date" class="form-control"
        autocomplete="off" [ngClass]="{ 'is-invalid': formSubmitted && f.dob.errors}" min="{{min}}" max="{{max}}">
        <div *ngIf="formSubmitted && f.dob.errors" class="invalid-feedback">
          <div *ngIf="f.dob.errors.required">Role is required</div>
        </div>
      </div>
      <div class="form-group col-sm-6 required">
        <label for="role" class="asterisk-if-mandatory">Role</label>
        <select required class="form-control" formControlName="role" id="role"
          [ngClass]="{ 'is-invalid': formSubmitted && f.role.errors }">
          <option value="" disabled selected>Select Role</option>
          <option *ngFor="let r of roles" [value]="r.id">{{r.name}}</option>
        </select>
        <div *ngIf="formSubmitted && f.role.errors" class="invalid-feedback">
          <div *ngIf="f.role.errors.required">Role is required</div>
        </div>
      </div>
    </div>
    <input required formControlName="merchant" id="merchant" type="text" class="form-control"
          [hidden]='true' [ngClass]="{ 'is-invalid': formSubmitted && f.confirmPassword.errors && f.confirmPassword.value != f.password.value}">
  </form>
  <div class="button-block">
    <button type="button" class="btn btn-primary form-button-cancel"
        (click)="cancel()">Cancel</button>
    <span class="pl-2" *ngIf="actionType == actionEnum.add">
      <button type="button" class="btn btn-primary form-button-action" (click)="save()">Save</button>
    </span>
    <span class="pl-2" *ngIf="actionType == actionEnum.edit">
      <button type="button" class="btn btn-primary form-button-action" (click)="update()">Update</button>
    </span>
    <span class="pl-2" *ngIf="actionType == actionEnum.view && hasAccess(actionEnum.edit) && user.status !== 2">
      <button type="button" class="btn btn-primary form-button-action" (click)="edit()"
        *ngIf="actionType == actionEnum.view">Edit</button>
    </span>
    <span class="pl-2" *ngIf="actionType == actionEnum.view && hasAccess(actionEnum.delete) && user.status !== 2">
      <button type="button" class="btn btn-primary form-button-action"
        (click)="openConfirmation(actionConfirm, 'user', actionEnum.delete, user.id, user.name)">Delete</button>
    </span>
    <span class="pl-2" *ngIf="actionType == actionEnum.view && hasAccess(actionEnum.activate) && user.status === 0">
      <button type="button" class="btn btn-primary form-button-action"
        (click)="openConfirmation(actionConfirm, 'user', actionEnum.activate, user.id, user.name)">Activate</button>
    </span>
    <span class="pl-2" *ngIf="actionType == actionEnum.view && hasAccess(actionEnum.inActivate) && user.status === 1">
      <button type="button" class="btn btn-primary form-button-action"
        (click)="openConfirmation(actionConfirm, 'user', actionEnum.inActivate, user.id, user.name)">In-Activate</button>
    </span>    
  </div>
</div>
<ng-template #actionConfirm let-modal>
  <app-confirm-dialog [resource]='confirmResource' (modalClosed)='closeConfirmation($event)'></app-confirm-dialog>
</ng-template>